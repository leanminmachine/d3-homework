<!DOCTYPE html>
<meta charset="utf-8">
<html>
  <head>
    <style>
        rect.bordered {
          stroke: #E6E6E6;
          stroke-width:2px;
        }
    </style>
    <script src="/vendor/d3.min.js"></script>
  </head>

  <body>
    <div id = "chart"></div>
    <script type = "text/javascript">
    // Variables
    // var margin = { top: 50, right: 0, bottom: 100, left: 30 },
    //      width = 960 - margin.left - margin.right,
    //      height = 430 - margin.top - margin.bottom,
    //      gridSize = Math.floor(width / 52),
    //      legendElementWidth = gridSize*2;

    //column
    var days = ["Mo", "Tu", "We", "Th", "Fr", "Sa", "Su"];
    var weeks = 52; // 52 weeks!!!
    var colors = ["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494"];
    var storageArr = [];

    // Create svg element
    // var svg = d3.select("#chart").append("svg")
    // .attr("width", width + margin.left + margin.right)
    // .attr("height", height + margin.top + margin.bottom)
    // .append("g")
    // .attr("transform", "translate(" + margin.left + "," + margin.top + ")");


    d3.json("/data/git-commit-frequency.json", function (error, data) {
      var colorScale = d3.scaleQuantile()
          .domain([0, 8, d3.max(data, function (d, i) {
             console.log(d.days);
            //  console.log("i value", i)
            return d.days; })])
          .range(colors);


  let gridSize = 20;
  let width = (gridSize + 1) * 7;
  let height = (gridSize + 1) * data.length;

  // define range!!!
  var x = d3.scaleLinear()
  .domain([0, 7])
  .range([0, width]);

  //52 weeks
  var y = d3.scaleLinear()
  .domain([0, data.length])
  .rangeRound([height, 0]);

  let svg = d3.select("body").append("svg")
    .attr("width", width)
  .attr("height", height)

  // Generate rows for each json object
  var rows = svg.selectAll('.row')
  .data(data)
  .enter()
  .append('g') //append to svg in html
  .attr("transform", function(d, i){
    return "translate(0," + y(i) + ")" // translate each row by y(i)
  })

  // Generate rects for the array of days per object
  let box = rows.selectAll("rect")
    .data(function(d){ return d.days }) // instead of dataset, use the array
    .enter()
    .append("rect")
    .attr("x", function(d, i) { return x(i); }) // use index to generate position for x
    .attr("width", gridSize)
    .attr("height", gridSize)
    .style("fill", colors[0])
    .attr("class", "bordered");

    box.transition().duration(1000)
    //  .data (function(d) { return d.days })
    .style("fill", function(d, i) {

      // d accesses each box, but we want to only access the d per row then apply colour
      console.log("data inside box transition DDAYS", d);

      // i -> just 0, 1, 2 ... 6
      return colors[i]})


    });



    </script>
  </body>
